---
title: "Exploratory analysing on World Happiness Report"
author:
- familyname: Li
  othernames: Weihao
  address: Monash University
  email: wlii0039@student.monash.edu
  correspondingauthor: true
  qualifications: 28723740
- familyname: Luo
  othernames: Jinhao
  address: Monash University
  email: jluo0015@student.monash.edu
  correspondingauthor: true
  qualifications: 29012449
department: Department of\newline Econometrics &\newline Business Statistics
organization: ETC5513 Assignment 4
bibliography: references.bib
biblio-style: apa
linestretch: 1.5
output:
  MonashEBSTemplates::report:
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=TRUE, messages=FALSE, warning=FALSE)
# Make sure you have the latest versions of rmarkdown and bookdown installed
library(ggplot2)
library(here)
library(tidyverse)
library(readr)
library(kableExtra)
library(lubridate)
```


# Introduction

# Total trends

```{r read-data}
happiness_2015 <- read_csv(here("data", "2015.csv"))
happiness_2016 <- read_csv(here("data", "2016.csv"))
happiness_2017 <- read_csv(here("data", "2017.csv"))
happiness_2018 <- read_csv(here("data", "2018.csv"))
happiness_2019 <- read_csv(here("data", "2019.csv"))
```

```{r top10-countries-2015}
top10_2015  <- happiness_2015 %>%
  filter(`Happiness Rank` <= 10) %>%
  select(Country, `Happiness Score`) %>%
  rename("2015-01-01" = "Happiness Score")

top10_2015 %>% 
  arrange(desc(`2015-01-01`)) %>% 
  rename("2015" = "2015-01-01") %>% 
  kable(caption = "Top10 countries in 2015") %>%
  kable_styling(bootstrap_options = c("bordered", "striped"))
```

```{r wrangling-2016-data}
data_2016 <- happiness_2016 %>% 
  select(Country, `Happiness Score`) %>% 
  rename("2016-01-01" = "Happiness Score")
```

```{r wrangling-2017-data}
data_2017 <- happiness_2017 %>% 
  select(Country, Happiness.Score) %>% 
  rename("2017-01-01" = "Happiness.Score")
```

```{r wrangling-2018-data}
data_2018 <- happiness_2018 %>% 
  select(`Country or region`, Score) %>% 
  rename("2018-01-01" = "Score",
         "Country" = "Country or region")
```

```{r wrangling-2019-data}
data_2019 <- happiness_2019 %>% 
  select(`Country or region`, Score) %>% 
  rename("2019-01-01" = "Score",
         "Country" = "Country or region")
```

```{r join-data-frame}
total_data <- list(top10_2015, data_2016, data_2017, data_2018, data_2019) %>%
  reduce(left_join, by = "Country")
```

```{r score_trends}
total_data_plot <- total_data %>%
  pivot_longer(c(`2015-01-01`,`2016-01-01`,`2017-01-01`,`2018-01-01`,`2019-01-01`), names_to = "year", values_to = "score") %>% 
  mutate(year = year(year))

total_data_plot %>% 
  ggplot(aes(year, score, colour = Country)) + 
  geom_line() + 
  geom_point(aes(shape = Country))
```





